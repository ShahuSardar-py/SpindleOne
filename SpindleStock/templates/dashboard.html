<!DOCTYPE html>
<html>
<head>
<title>Stock Dashboard</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body { background:#f4f6f9; }
.sidebar { height:100vh; background:#1e293b; padding:20px; }
.sidebar a { color:white; display:block; margin:10px 0; text-decoration:none; }
.sidebar a:hover { color:#38bdf8; }
.card { border:none; border-radius:12px; box-shadow:0 4px 10px rgba(0,0,0,0.05); }
</style>
</head>

<body>
<div class="container-fluid">
<div class="row">

<!-- Sidebar -->
<div class="col-2 sidebar">
<h4 class="text-info">Spindle Stock</h4>
<hr>
<a href="/stock/">Dashboard</a>
<a href="/stock/raw">Raw Material</a>
<a href="/stock/production">Production</a>
<a href="/stock/inventory">Stock Balance</a>
</div>

<!-- Content -->
<div class="col-10 p-4">

<h3>Stock Dashboard</h3>

<!-- Raw Material Summary -->
<div class="card p-4 mb-4">
<h5>Available Raw Materials</h5>

<table class="table table-hover">
<tr>
<th>Material</th>
<th>Available Quantity</th>
<th>Expiry Date</th>
</tr>

{% for m in materials %}
<tr>
<td>{{ m.name }}</td>
<td>{{ m.quantity }} {{ m.unit }}</td>
<td>
{{ m.expiry_date.strftime("%d %b %Y") if m.expiry_date else "" }}
</td>
</tr>
{% endfor %}

</table>
</div>

<!-- Production Chart -->
<div class="card p-4">
<h5>Production Quantity per Product</h5>
<canvas id="prodChart"></canvas>
</div>

</div>
</div>
</div>

<script id="product-data" type="application/json">
{{ product_data | tojson }}
</script>

<script>
const productData = JSON.parse(
    document.getElementById("product-data").textContent
);

const labels = Object.keys(productData);
const values = Object.values(productData);

new Chart(document.getElementById('prodChart'), {
    type: 'bar',
    data: {
        labels: labels,
        datasets: [{
            label: 'Produced Quantity',
            data: values,
            borderWidth: 1
        }]
    }
});
</script>

</body>
</html>