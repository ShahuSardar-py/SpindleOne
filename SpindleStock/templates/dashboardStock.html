{% extends "base.html" %}

{% block title %}Stock Dashboard{% endblock %}

{% block content %}
<div class="flex h-[calc(100vh-72px)]">

    <!-- Sidebar -->
    <div class="w-64 bg-white border-r overflow-y-auto">

        <div class="p-6 border-b border-gray-200">
            <h2 class="text-xl font-bold text-gray-900">SpindleStock</h2>
        </div>

            <div class="p-4">

    <a href="/stock/"
       class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors mb-2
       {% if request.endpoint == 'spindlestock.dashboard' %}
           bg-primary-50 text-primary-600 border-r-4 border-primary-600
       {% else %}
           text-gray-600 hover:bg-gray-50
       {% endif %}">
        <span class="text-xl">üìä</span>
        <span>Dashboard</span>
    </a>

    <a href="/stock/raw"
       class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors mb-2
       {% if request.endpoint == 'spindlestock.raw_material' %}
           bg-primary-50 text-primary-600 border-r-4 border-primary-600
       {% else %}
           text-gray-600 hover:bg-gray-50
       {% endif %}">
        <span class="text-xl">üì¶</span>
        <span>Raw Material</span>
    </a>

    <a href="/stock/production"
       class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors mb-2
       {% if request.endpoint == 'spindlestock.production' %}
           bg-primary-50 text-primary-600 border-r-4 border-primary-600
       {% else %}
           text-gray-600 hover:bg-gray-50
       {% endif %}">
        <span class="text-xl">üè≠</span>
        <span>Production</span>
    </a>

    <a href="/stock/inventory"
       class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors
       {% if request.endpoint == 'spindlestock.inventory' %}
           bg-primary-50 text-primary-600 border-r-4 border-primary-600
       {% else %}
           text-gray-600 hover:bg-gray-50
       {% endif %}">
        <span class="text-xl">üìã</span>
        <span>Stock Balance</span>
    </a>

</div>
        </div>

    <!-- Content -->
    <div class="flex-1 p-6 overflow-y-auto">

        <h3 class="text-2xl font-semibold mb-6">
            Stock Dashboard
        </h3>

        <div class="card p-6">
            <h5 class="font-semibold mb-4">
                Production Quantity per Product
            </h5>

            <!-- Chart height fixed -->
            <div class="h-96">
                <canvas id="prodChart"></canvas>
            </div>

        </div>

    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script id="product-data" type="application/json">
{{ product_data | tojson }}
</script>

<script>
const productData = JSON.parse(
    document.getElementById("product-data").textContent
);

const labels = Object.keys(productData);
const values = Object.values(productData);

new Chart(document.getElementById('prodChart'), {
    type: 'bar',
    data: {
        labels: labels,
        datasets: [{
            label: 'Produced Quantity',
            data: values,
            borderWidth: 1
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: false
    }
});
</script>
{% endblock %}