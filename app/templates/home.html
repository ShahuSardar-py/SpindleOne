{% extends "base.html" %}

{% block content %}
<div class="container mx-auto px-4 py-8 max-w-7xl">
    <!-- Hero Section -->
    <div class="text-center mb-12">
        <h1 class="text-5xl font-bold text-gray-900 mb-3">SpindleOne</h1>
        <p class="text-xl text-gray-600">Integrated Management Suite for Modern Enterprises</p>
    </div>

    <!-- Role Selector -->
    <div class="max-w-md mx-auto mb-12">
        <div class="card p-6">
            <label for="roleSelector" class="block text-sm font-semibold text-gray-700 uppercase tracking-wide mb-3">
                Select Your Role
            </label>
            <select id="roleSelector" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all">
                <option value="super-admin">Super Admin</option>
                <option value="store-keeper">Store Keeper</option>
                <option value="account-dept">Account Department</option>
                <option value="hr">HR Department</option>
            </select>
        </div>
    </div>

    <!-- Modules Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        <!-- SpindleFinance -->
        <div class="card module-card hidden hover:shadow-xl hover:-translate-y-2 transition-all duration-300 cursor-pointer" 
             data-roles="super-admin,account-dept">
            <div class="p-8 flex flex-col h-full">
                <div class="text-6xl mb-4 text-center">üí∞</div>
                <h2 class="text-2xl font-bold text-gray-900 mb-3">SpindleFinance</h2>
                <p class="text-gray-600 mb-6 flex-grow">
                    Manage cash flow and analytics with precision and control.
                </p>
                <button onclick="navigateTo('finance')" class="btn-primary w-full">
                    Access Module
                </button>
            </div>
        </div>

        <!-- SpindleSupply -->
        <div class="card module-card hidden hover:shadow-xl hover:-translate-y-2 transition-all duration-300 cursor-pointer" 
             data-roles="super-admin,store-keeper">
            <div class="p-8 flex flex-col h-full">
                <div class="text-6xl mb-4 text-center">üì¶</div>
                <h2 class="text-2xl font-bold text-gray-900 mb-3">SpindleSupply</h2>
                <p class="text-gray-600 mb-6 flex-grow">
                    Track inventory, manage supply chain, and optimize stock levels efficiently.
                </p>
                <button onclick="navigateTo('supply')" class="btn-primary w-full">
                    Access Module
                </button>
            </div>
        </div>
        <!-- SpindleStock -->
        <div class="card module-card hidden hover:shadow-xl hover:-translate-y-2 transition-all duration-300 cursor-pointer" 
            data-roles="super-admin,store-keeper">
            <div class="p-8 flex flex-col h-full">
                <div class="text-6xl mb-4 text-center">üè≠</div>
                <h2 class="text-2xl font-bold text-gray-900 mb-3">SpindleStock</h2>
                <p class="text-gray-600 mb-6 flex-grow">
                    Manage raw materials, production, and finished inventory.
                </p>
                <button onclick="navigateTo('stock')" class="btn-primary w-full">
                    Access Module
                </button>
            </div>
        </div>
        <!-- SpindlePeople -->
        <div class="card module-card hidden hover:shadow-xl hover:-translate-y-2 transition-all duration-300 cursor-pointer" 
             data-roles="super-admin,hr">
            <div class="p-8 flex flex-col h-full">
                <div class="text-6xl mb-4 text-center">üë•</div>
                <h2 class="text-2xl font-bold text-gray-900 mb-3">SpindlePeople</h2>
                <p class="text-gray-600 mb-6 flex-grow">
                    Manage attendance records.
                </p>
                <button onclick="navigateTo('people')" class="btn-primary w-full">
                    Access Module
                </button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
    const roleSelector = document.getElementById('roleSelector');
    const moduleCards = document.querySelectorAll('.module-card');

    function updateVisibility(selectedRole) {
        moduleCards.forEach(card => {
            const allowedRoles = card.getAttribute('data-roles').split(',');
            if (allowedRoles.includes(selectedRole)) {
                card.classList.remove('hidden');
            } else {
                card.classList.add('hidden');
            }
        });
    }

    roleSelector.addEventListener('change', (e) => {
        updateVisibility(e.target.value);
        localStorage.setItem('selectedRole', e.target.value);
    });

    const savedRole = localStorage.getItem('selectedRole') || 'super-admin';
    roleSelector.value = savedRole;
    updateVisibility(savedRole);

   function navigateTo(module) {
    if (module === 'people') {
        window.location.href = '/hr/employees';

    } else if (module === 'finance') {
        window.location.href = '/finance/add';

    } else if (module === 'supply') {
        alert('SpindleSupply module coming soon!');

    } else if (module === 'stock') {
        window.location.href = '/stock/';
    }
}
</script>
{% endblock %}